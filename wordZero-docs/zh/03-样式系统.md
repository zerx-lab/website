# 样式系统

WordZero 提供了遵循 OOXML 规范的全面样式管理系统。本文档涵盖预定义样式、自定义样式创建和 QuickStyleAPI。

## 概述

样式系统由三个主要组件组成：

1. **StyleManager** - 核心样式管理和注册
2. **QuickStyleAPI** - 高级便捷接口
3. **预定义样式** - 18 种开箱即用的内置样式

## 预定义样式

WordZero 包含 18 种预定义样式：

### 段落样式

| 样式 ID | 常量 | 描述 |
|---------|------|------|
| Heading1 | `style.StyleHeading1` | 一级标题（最大） |
| Heading2 | `style.StyleHeading2` | 二级标题 |
| Heading3 | `style.StyleHeading3` | 三级标题 |
| Heading4 | `style.StyleHeading4` | 四级标题 |
| Heading5 | `style.StyleHeading5` | 五级标题 |
| Heading6 | `style.StyleHeading6` | 六级标题 |
| Heading7 | `style.StyleHeading7` | 七级标题 |
| Heading8 | `style.StyleHeading8` | 八级标题 |
| Heading9 | `style.StyleHeading9` | 九级标题 |
| Title | `style.StyleTitle` | 文档标题 |
| Subtitle | `style.StyleSubtitle` | 文档副标题 |
| Normal | `style.StyleNormal` | 默认正文 |
| Quote | `style.StyleQuote` | 块引用 |
| ListParagraph | `style.StyleListParagraph` | 列表项 |
| CodeBlock | `style.StyleCodeBlock` | 代码块 |

### 字符样式

| 样式 ID | 常量 | 描述 |
|---------|------|------|
| Emphasis | `style.StyleEmphasis` | 斜体强调 |
| Strong | `style.StyleStrong` | 加粗强调 |
| CodeChar | `style.StyleCodeChar` | 行内代码 |

## 使用预定义样式

```go
import (
    "github.com/zerx-lab/wordZero/pkg/document"
    "github.com/zerx-lab/wordZero/pkg/style"
)

func main() {
    doc := document.New()

    // 应用标题样式
    h1 := doc.AddParagraph("主标题")
    h1.SetStyle(style.StyleHeading1)

    h2 := doc.AddParagraph("章节标题")
    h2.SetStyle(style.StyleHeading2)

    // 应用正文样式
    body := doc.AddParagraph("这是正文内容。")
    body.SetStyle(style.StyleNormal)

    // 应用引用样式
    quote := doc.AddParagraph("这是一段引用。")
    quote.SetStyle(style.StyleQuote)

    // 应用代码块样式
    code := doc.AddParagraph("func main() { }")
    code.SetStyle(style.StyleCodeBlock)

    doc.Save("styled-document.docx")
}
```

## StyleManager

StyleManager 是管理样式的核心组件：

```go
// 从文档获取样式管理器
styleManager := doc.GetStyleManager()

// 检查样式是否存在
if styleManager.HasStyle("Heading1") {
    fmt.Println("Heading1 样式可用")
}

// 获取样式信息
styleInfo := styleManager.GetStyle("Heading1")

// 列出所有可用样式
styles := styleManager.ListStyles()
for _, s := range styles {
    fmt.Printf("样式: %s, 类型: %s\n", s.ID, s.Type)
}
```

## QuickStyleAPI

QuickStyleAPI 提供了处理样式的高级接口：

```go
import "github.com/zerx-lab/wordZero/pkg/style"

// 从 StyleManager 创建 QuickStyleAPI
styleManager := doc.GetStyleManager()
quickAPI := style.NewQuickStyleAPI(styleManager)

// 获取样式信息
info, err := quickAPI.GetStyleInfo("Heading1")
if err == nil {
    fmt.Printf("名称: %s\n", info.Name)
    fmt.Printf("类型: %s\n", info.Type)
    fmt.Printf("基于: %s\n", info.BasedOn)
}
```

## 创建自定义样式

### 使用 QuickStyleConfig

```go
import "github.com/zerx-lab/wordZero/pkg/style"

styleManager := doc.GetStyleManager()
quickAPI := style.NewQuickStyleAPI(styleManager)

// 创建自定义段落样式
config := style.QuickStyleConfig{
    ID:      "MyCustomStyle",
    Name:    "我的自定义样式",
    Type:    style.StyleTypeParagraph,
    BasedOn: "Normal", // 从 Normal 样式继承

    // 段落属性
    ParagraphConfig: &style.QuickParagraphConfig{
        Alignment:   "center",
        SpaceBefore: 240,  // 段前 12pt
        SpaceAfter:  120,  // 段后 6pt
        LineSpacing: 360,  // 1.5 倍行距
    },

    // 文本属性
    RunConfig: &style.QuickRunConfig{
        FontFamily: "Georgia",
        FontSize:   14,
        Bold:       true,
        FontColor:  "2E74B5", // 蓝色
    },
}

customStyle, err := quickAPI.CreateQuickStyle(config)
if err != nil {
    log.Fatal(err)
}

// 使用自定义样式
para := doc.AddParagraph("带自定义样式的文本")
para.SetStyle("MyCustomStyle")
```

### QuickParagraphConfig 选项

```go
type QuickParagraphConfig struct {
    Alignment       string  // "left"（左对齐）, "center"（居中）, "right"（右对齐）, "justify"（两端对齐）
    SpaceBefore     int     // 段前间距（twips）
    SpaceAfter      int     // 段后间距（twips）
    LineSpacing     int     // 行间距（twips）
    LineSpacingRule string  // "auto", "exact", "atLeast"
    FirstLineIndent int     // 首行缩进（twips）
    LeftIndent      int     // 左缩进（twips）
    RightIndent     int     // 右缩进（twips）
    KeepWithNext    bool    // 与下段同页
    KeepLines       bool    // 段中不分页
    PageBreakBefore bool    // 段前分页
    OutlineLevel    int     // 大纲级别（0-9）
}
```

### QuickRunConfig 选项

```go
type QuickRunConfig struct {
    FontFamily    string  // 字体名称（如 "Arial"）
    FontSize      float64 // 字号（单位：磅）
    Bold          bool    // 加粗
    Italic        bool    // 斜体
    Underline     bool    // 下划线
    Strike        bool    // 删除线
    FontColor     string  // 十六进制颜色代码
    Highlight     string  // 高亮颜色
    AllCaps       bool    // 全部大写
    SmallCaps     bool    // 小型大写
    Superscript   bool    // 上标
    Subscript     bool    // 下标
}
```

## 样式继承

WordZero 中的样式通过 `BasedOn` 属性支持继承：

```go
// 创建基础样式
baseConfig := style.QuickStyleConfig{
    ID:      "BaseStyle",
    Name:    "基础样式",
    Type:    style.StyleTypeParagraph,
    RunConfig: &style.QuickRunConfig{
        FontFamily: "Arial",
        FontSize:   12,
    },
}
quickAPI.CreateQuickStyle(baseConfig)

// 创建派生样式
derivedConfig := style.QuickStyleConfig{
    ID:      "DerivedStyle",
    Name:    "派生样式",
    Type:    style.StyleTypeParagraph,
    BasedOn: "BaseStyle", // 从 BaseStyle 继承

    // 只覆盖特定属性
    RunConfig: &style.QuickRunConfig{
        Bold: true, // 添加加粗，继承字体和字号
    },
}
quickAPI.CreateQuickStyle(derivedConfig)
```

## 样式类型

WordZero 支持四种样式类型：

```go
const (
    StyleTypeParagraph = "paragraph" // 段落样式
    StyleTypeCharacter = "character" // 字符样式
    StyleTypeTable     = "table"     // 表格样式
    StyleTypeNumbering = "numbering" // 编号样式
)
```

## 创建字符样式

字符样式只影响文本格式，不影响段落格式：

```go
charConfig := style.QuickStyleConfig{
    ID:   "HighlightedCode",
    Name: "高亮代码",
    Type: style.StyleTypeCharacter,

    RunConfig: &style.QuickRunConfig{
        FontFamily: "Consolas",
        FontSize:   10,
        FontColor:  "C7254E",
        Highlight:  "yellow",
    },
}
quickAPI.CreateQuickStyle(charConfig)
```

## 最佳实践

1. **尽可能使用预定义样式** - 它们经过优化和充分测试。

2. **使用有意义的样式名称** - 选择能反映用途的描述性 ID。

3. **利用继承** - 创建基础样式并派生特定样式以保持一致性。

4. **限制自定义样式数量** - 过多的样式会使文档难以维护。

5. **在不同 Word 版本中测试** - 验证您的自定义样式在不同版本的 Microsoft Word 中是否正确渲染。

```go
// 良好做法：创建一致的样式层次结构
baseConfig := style.QuickStyleConfig{
    ID:      "CompanyBase",
    Name:    "公司基础样式",
    Type:    style.StyleTypeParagraph,
    RunConfig: &style.QuickRunConfig{
        FontFamily: "Calibri",
        FontSize:   11,
    },
}

headingConfig := style.QuickStyleConfig{
    ID:      "CompanyHeading",
    Name:    "公司标题样式",
    Type:    style.StyleTypeParagraph,
    BasedOn: "CompanyBase",
    RunConfig: &style.QuickRunConfig{
        Bold:     true,
        FontSize: 16,
    },
}
```
